# TodoGravita å‰ç«¯æž¶æž„æ–‡æ¡£

## ðŸ—ï¸ ç³»ç»Ÿæž¶æž„æ¦‚è§ˆ

TodoGravita å‰ç«¯æ˜¯ä¸€ä¸ªåŸºäºŽ React çš„å•é¡µåº”ç”¨ (SPA)ï¼Œä½¿ç”¨ TypeScript æž„å»ºï¼Œå…·æœ‰çŽ°ä»£ç»„ä»¶æž¶æž„ã€æ€§èƒ½ä¼˜åŒ–å’Œå…¨é¢çš„æµ‹è¯•è¦†ç›–ã€‚

### æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æž¶**: React 18.x + TypeScript
- **æž„å»ºå·¥å…·**: Vite 5.x
- **æµ‹è¯•**: Vitest + React Testing Library
- **ç›‘æŽ§**: Sentry
- **æ ·å¼**: CSS Modules + è‡ªå®šä¹‰ CSS (æ”¯æŒæ¯›çŽ»ç’ƒæ•ˆæžœ)
- **çŠ¶æ€ç®¡ç†**: React Context + Hooks
- **æ‹–æ‹½äº¤äº’**: è‡ªå®šä¹‰æ‹–æ‹½é€»è¾‘ (æ”¯æŒé¼ æ ‡å’Œè§¦æ‘¸)
- **HTTP å®¢æˆ·ç«¯**: Axios

## ðŸ“ ç»„ä»¶æž¶æž„

### æ ¸å¿ƒç»„ä»¶

#### 1. App.tsx (æ ¹ç»„ä»¶)

- **èŒè´£**: åº”ç”¨ç¼–æŽ’å’Œå…¨å±€çŠ¶æ€ç®¡ç†
- **ç‰¹æ€§**: å¾…åŠžäº‹é¡¹ CRUD æ“ä½œã€ä¹è§‚æ›´æ–°ã€æ€§èƒ½ä¼˜åŒ–
- **ä¼˜åŒ–**: è®°å¿†åŒ–è±¡é™ç»Ÿè®¡ã€æ‰¹é‡çŠ¶æ€æ›´æ–°

#### 2. TodoList.tsx

- **èŒè´£**: å¾…åŠžäº‹é¡¹åˆ—è¡¨æ¸²æŸ“å’Œç®¡ç†
- **ç‰¹æ€§**: è®°å¿†åŒ–é¡¹ç›®æ¸²æŸ“ã€ç¨³å®šçš„ç»„ä»¶å¼•ç”¨
- **ä¼˜åŒ–**: ä½¿ç”¨ React.memo å‡å°‘ä¸å¿…è¦çš„é‡æ¸²æŸ“

#### 3. TodoItem.tsx

- **èŒè´£**: å•ä¸ªå¾…åŠžäº‹é¡¹çš„æ˜¾ç¤ºå’Œäº¤äº’
- **ç‰¹æ€§**: ç¼–è¾‘æ¨¡å¼ã€å®ŒæˆçŠ¶æ€åˆ‡æ¢ã€æ‹–æ‹½æ”¯æŒ
- **ä¼˜åŒ–**: ç¼“å­˜æ—¶é—´æ˜¾ç¤ºã€ä¼˜åŒ–çš„è±¡é™è®¡ç®—

#### 4. TodoForm.tsx

- **èŒè´£**: å¾…åŠžäº‹é¡¹çš„åˆ›å»ºå’Œç¼–è¾‘
- **ç‰¹æ€§**: æ—¶é—´æ ¡éªŒã€è¡¨å•çŠ¶æ€ç®¡ç†
- **ä¼˜åŒ–**: è®°å¿†åŒ– TimeSelector å›žè°ƒå‡½æ•°

#### 5. è§†å›¾ç»„ä»¶ (QuadrantView, MatrixView, DashboardView)

- **èŒè´£**: å¾…åŠžäº‹é¡¹çš„ä¸“ä¸šåŒ–è§†å›¾å±•ç¤º
- **ç‰¹æ€§**: è‰¾æ£®è±ªå¨å°”çŸ©é˜µã€ä¼˜å…ˆçº§çŸ©é˜µã€æ•°æ®åˆ†æžä»ªè¡¨ç›˜
- **ä¼˜åŒ–**: QuadrantView é‡‡ç”¨ Canvas æ¸²æŸ“ï¼ŒDashboard é‡‡ç”¨è®°å¿†åŒ–æ•°æ®èšåˆ

#### 6. Sidebar.tsx

- **èŒè´£**: åº”ç”¨å¯¼èˆªå’Œå…¨å±€æ“ä½œ
- **ç‰¹æ€§**: è§†å›¾åˆ‡æ¢ã€è®¾ç½®å…¥å£ã€å¿«é€Ÿç»Ÿè®¡

#### 7. AppearanceSettings.tsx

- **èŒè´£**: ä¸ªæ€§åŒ–å’Œç³»ç»Ÿé…ç½®
- **ç‰¹æ€§**: å£çº¸ä¸Šä¼ ã€ä¸»é¢˜é€‰æ‹©ã€æ¯›çŽ»ç’ƒæ•ˆæžœè°ƒèŠ‚

### ä¸Šä¸‹æ–‡ (Context) æž¶æž„

#### TodoContext

- **ç”¨é€”**: é›†ä¸­ç®¡ç†å¾…åŠžäº‹é¡¹æ•°æ®å’Œæ“ä½œ
- **ç‰¹æ€§**: CRUD æ“ä½œã€è¿‡æ»¤ã€æŽ’åºã€å›žæ”¶ç«™ç®¡ç†

#### SettingsContext

- **ç”¨é€”**: åº”ç”¨åå¥½å’Œå¤–è§‚è®¾ç½®
- **ç‰¹æ€§**: ä¸»é¢˜ç®¡ç†ã€å£çº¸æŒä¹…åŒ–ã€UI é…ç½®

#### LoadingContext

- **ç”¨é€”**: å…¨å±€åŠ è½½çŠ¶æ€ç®¡ç†
- **ç‰¹æ€§**: åŠ è½½é®ç½©ã€å¼‚æ­¥æ“ä½œåè°ƒ
- **ä¼˜åŒ–**: è®°å¿†åŒ–ä¸Šä¸‹æ–‡å€¼ä»¥é˜²æ­¢ä¸å¿…è¦çš„é‡æ¸²æŸ“

#### ToastContext

- **ç”¨é€”**: å…¨å±€é€šçŸ¥ç³»ç»Ÿ
- **ç‰¹æ€§**: æ°”æ³¡æ¶ˆæ¯ã€è‡ªåŠ¨æ¶ˆå¤±ã€æ”¯æŒå¤šæ¡æ¶ˆæ¯
- **ä¼˜åŒ–**: è®°å¿†åŒ– Toast é¡¹ç›®æ¸²æŸ“

### Hook æž¶æž„

#### useTimeValidation

- **ç”¨é€”**: æ—¶é—´è¾“å…¥æ ¡éªŒ
- **ç‰¹æ€§**: æ ¼å¼æ ¡éªŒã€èŒƒå›´æ£€æŸ¥
- **æµ‹è¯•**: 100% æµ‹è¯•è¦†ç›–çŽ‡

#### useDragLogic

- **ç”¨é€”**: æ‹–æ‹½äº¤äº’å¤„ç†
- **ç‰¹æ€§**: æ”¯æŒé¼ æ ‡/è§¦æ‘¸ã€è±¡é™å®šä½
- **æµ‹è¯•**: å…¨é¢çš„æµ‹è¯•å¥—ä»¶

#### usePerformance

- **ç”¨é€”**: æ€§èƒ½ç›‘æŽ§å’Œä¼˜åŒ–
- **ç‰¹æ€§**: æ¸²æŸ“è¿½è¸ªã€æ€§èƒ½æŒ‡æ ‡ç»Ÿè®¡
- **æµ‹è¯•**: æ€§èƒ½åŸºå‡†æµ‹è¯•ã€æ¸²æŸ“åˆ†æž

## âš¡ æ€§èƒ½æž¶æž„

### ä¼˜åŒ–ç­–ç•¥

#### 1. ç»„ä»¶è®°å¿†åŒ– (Memoization)

```typescript
// TodoList.tsx - è®°å¿†åŒ–å¾…åŠžäº‹é¡¹æ¸²æŸ“
const todoItems = useMemo(() => {
  return todos.map((todo) => (
    <TodoItemComponent
      key={todo.id}
      todo={todo}
      onToggleComplete={onToggleComplete}
      onDelete={onDelete}
      onUpdate={onUpdate}
    />
  ))
}, [todos, onToggleComplete, onDelete, onUpdate])
```

#### 2. æ˜‚è´µè®¡ç®—ç¼“å­˜

```typescript
// App.tsx - ç¼“å­˜è±¡é™ç»Ÿè®¡å’Œæ™ºèƒ½ä¼˜å…ˆçº§
const quadrantStats = useMemo(() => {
  // ç¼“å­˜å¤šç»´åº¦ä¼˜å…ˆçº§è¯„åˆ†
  return calculateQuadrantStats(todos);
}, [todos]);
```

#### 3. å‡½æ•°å¼•ç”¨ç¨³å®šåŒ–

```typescript
// TodoForm.tsx - è®°å¿†åŒ–å›žè°ƒå‡½æ•°
const handleStartTimeChange = useCallback((time: string) => {
  setStartTime(time);
  validateTimeRange(time, endTime);
}, [endTime, validateTimeRange]);
```

#### 4. ä»£ç åˆ†å‰² (Code Splitting)

```typescript
// App.tsx - å¯¹å¤§åž‹ç»„ä»¶ä½¿ç”¨å»¶è¿ŸåŠ è½½
const RecycleBin = lazy(() => import('./components/RecycleBin'));
const AppearanceSettings = lazy(() => import('./components/AppearanceSettings'));
```

### æ€§èƒ½ç›‘æŽ§

- CI æµç¨‹ä¸­çš„åŒ…ä½“ç§¯åˆ†æž
- ç»„ä»¶æ¸²æŸ“è¿½è¸ª
- å¼ºåˆ¶æ‰§è¡Œæ€§èƒ½é¢„ç®—

## ðŸ§ª æµ‹è¯•æž¶æž„

### æµ‹è¯•ç­–ç•¥

#### ç»„ä»¶æµ‹è¯•

- **è¦†ç›–çŽ‡ç›®æ ‡**: æ ¸å¿ƒç»„ä»¶ 90% ä»¥ä¸Š
- **å·¥å…·**: Vitest + React Testing Library
- **é‡ç‚¹**: ç”¨æˆ·äº¤äº’ã€æ— éšœç¢æ”¯æŒã€è¾¹ç•Œæƒ…å†µ

#### Hook æµ‹è¯•

- **è¦†ç›–çŽ‡ç›®æ ‡**: è‡ªå®šä¹‰ Hook 100%
- **å·¥å…·**: Vitest + React Hooks Testing Library
- **é‡ç‚¹**: çŠ¶æ€ç®¡ç†ã€å‰¯ä½œç”¨ã€é”™è¯¯å¤„ç†

#### å·¥å…·å‡½æ•°æµ‹è¯•

- **è¦†ç›–çŽ‡ç›®æ ‡**: å·¥å…·å‡½æ•° 100%
- **å·¥å…·**: Vitest
- **é‡ç‚¹**: è¾¹ç•Œæƒ…å†µã€æ€§èƒ½ã€æ­£ç¡®æ€§

### æµ‹è¯•ç»“æž„

```text
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Component.tsx
â”‚   â””â”€â”€ Component.test.tsx
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useHook.ts
â”‚   â””â”€â”€ useHook.test.ts
â””â”€â”€ utils/
    â”œâ”€â”€ util.ts
    â””â”€â”€ util.test.ts
```

### Mock ç­–ç•¥

- **API Mocks**: ä½¿ç”¨ MSW (Mock Service Worker) æ‹¦æˆªè¯·æ±‚
- **ç»„ä»¶ Mocks**: å¯¹å¤æ‚ä¾èµ–ä½¿ç”¨ Vitest mocks
- **æ•°æ® Mocks**: åœ¨ `src/test/mock-data.ts` é›†ä¸­ç®¡ç†æ¨¡æ‹Ÿæ•°æ®

## ðŸ”„ çŠ¶æ€ç®¡ç†æž¶æž„

### å±€éƒ¨çŠ¶æ€æ¨¡å¼

- **ç†å¿µ**: çŠ¶æ€åº”å°½å¯èƒ½é è¿‘ä½¿ç”¨å®ƒçš„åœ°æ–¹
- **å®žçŽ°**: ä½¿ç”¨ useState å’Œ useReducer hooks
- **ä¼˜ç‚¹**: å¯é¢„æµ‹ã€æ˜“æµ‹è¯•ã€æ€§èƒ½å¥½

### ä¸Šä¸‹æ–‡æ¨¡å¼

- **å…¨å±€çŠ¶æ€**: åŠ è½½çŠ¶æ€ã€é€šçŸ¥
- **åŠŸèƒ½çŠ¶æ€**: å¾…åŠžäº‹é¡¹ç®¡ç†ã€ç”¨æˆ·åå¥½
- **æ€§èƒ½**: è®°å¿†åŒ–ä¸Šä¸‹æ–‡å€¼

### çŠ¶æ€æµ

```text
ç”¨æˆ·æ“ä½œ â†’ å±€éƒ¨çŠ¶æ€æ›´æ–° â†’ API è°ƒç”¨ â†’ ä¸Šä¸‹æ–‡æ›´æ–° â†’ UI æ›´æ–°
```

## ðŸŒ API é›†æˆæž¶æž„

### æœåŠ¡å±‚

- **æ–‡ä»¶**: `src/services/api.ts`
- **ç‰¹æ€§**: Axios æ‹¦æˆªå™¨ã€é”™è¯¯å¤„ç†ã€è¯·æ±‚/å“åº”è½¬æ¢
- **æµ‹è¯•**: æµ‹è¯•ä¸­é€šè¿‡ Mock æ‹¦æˆª API è°ƒç”¨

### é”™è¯¯å¤„ç†

- **å…¨å±€**: Axios æ‹¦æˆªå™¨å¤„ç†ç½‘ç»œé”™è¯¯
- **å±€éƒ¨**: ç»„ä»¶çº§é”™è¯¯è¾¹ç•Œ (Error Boundaries)
- **ç”¨æˆ·åé¦ˆ**: ä½¿ç”¨ Toast é€šçŸ¥å±•ç¤ºç”¨æˆ·å¯è§çš„é”™è¯¯

### ä¹è§‚æ›´æ–° (Optimistic Updates)

```typescript
// App.tsx - ä¹è§‚æ›´æ–°å®ŒæˆçŠ¶æ€
const handleToggleComplete = useCallback(async (id: number) => {
  // ä¹è§‚æ›´æ–° UI
  setTodos(prevTodos =>
    prevTodos.map(todo =>
      todo.id === id ? { ...todo, completed: !todo.completed } : todo
    )
  );
  
  // API è°ƒç”¨ï¼Œå¤±è´¥æ—¶å›žæ»š
  try {
    await todoApi.toggleTodoStatus(id);
  } catch (err) {
    // å¤±è´¥æ—¶å›žæ»šçŠ¶æ€
    setTodos(prevTodos =>
      prevTodos.map(todo =>
        todo.id === id ? { ...todo, completed: !todo.completed } : todo
      )
    );
    showToast('æ›´æ–°çŠ¶æ€å¤±è´¥', 'error');
  }
}, [showToast]);
```

## ðŸŽ¨ UI/UX æž¶æž„

### ç»„ä»¶è®¾è®¡åŽŸåˆ™

- **åŽŸå­è®¾è®¡**: åŽŸå­ â†’ åˆ†å­ â†’ æœ‰æœºä½“
- **ä¸€è‡´æ€§**: å…·æœ‰ç»Ÿä¸€ API çš„å¯é‡ç”¨ç»„ä»¶
- **æ— éšœç¢**: ARIA æ ‡ç­¾ã€é”®ç›˜å¯¼èˆªã€å±å¹•é˜…è¯»å™¨æ”¯æŒ

### æ ·å¼æž¶æž„

- **CSS Modules**: ç»„ä»¶çº§æ ·å¼ä½œç”¨åŸŸ
- **CSS Variables**: æ”¯æŒä¸»é¢˜è‡ªå®šä¹‰
- **å“åº”å¼è®¾è®¡**: ç§»åŠ¨ç«¯ä¼˜å…ˆåŽŸåˆ™

### ä¸»é¢˜ç³»ç»Ÿ

- **äº®/æš—æ¨¡å¼**: åŸºäºŽ CSS å˜é‡çš„ä¸»é¢˜åˆ‡æ¢
- **å¯è‡ªå®šä¹‰**: æŒä¹…åŒ–ç”¨æˆ·åå¥½è®¾ç½®
- **ä¸€è‡´æ€§**: é›†ä¸­åŒ–çš„è®¾è®¡ä»¤ç‰Œ (Design Tokens)

## ðŸ”§ å¼€å‘ä½“éªŒæž¶æž„

### å·¥å…·é“¾

- **TypeScript**: ç±»åž‹å®‰å…¨å’Œ IDE æ”¯æŒ
- **ESLint**: ä»£ç è´¨é‡å¼ºåˆ¶æ‰§è¡Œ
- **Prettier**: ä¸€è‡´çš„ä»£ç æ ¼å¼åŒ–
- **Vitest**: æžé€Ÿæµ‹è¯•æ‰§è¡Œ
- **Vite**: æžé€Ÿå¼€å‘æž„å»º

### å¼€å‘å·¥ä½œæµ

1. **æœ¬åœ°å¼€å‘**: `npm run dev`
2. **æµ‹è¯•**: `npm run test:watch`
3. **ä»£ç è§„èŒƒæ£€æŸ¥**: `npm run lint`
4. **ç±»åž‹æ£€æŸ¥**: `npm run typecheck`
5. **æž„å»º**: `npm run build`

### CI/CD æµæ°´çº¿

- **GitHub Actions**: è‡ªåŠ¨åŒ–æµ‹è¯•å’Œéƒ¨ç½²
- **è¦†ç›–çŽ‡æŠ¥å‘Š**: è‡ªåŠ¨åŒ–è¦†ç›–çŽ‡è¿½è¸ª
- **æ€§èƒ½ç›‘æŽ§**: åŒ…ä½“ç§¯åˆ†æž
- **è´¨é‡é—¨ç¦**: è§„èŒƒæ£€æŸ¥ã€ç±»åž‹æ£€æŸ¥ã€æµ‹è¯•æ‰§è¡Œ

## ðŸ“Š æ€§èƒ½æŒ‡æ ‡

### å½“å‰æ€§èƒ½

- **åŒ…ä½“ç§¯**: ~250 KB (gzipped)
- **æµ‹è¯•è¦†ç›–çŽ‡**: çº¦ 98% è¡Œè¦†ç›–çŽ‡, çº¦ 96% å‡½æ•°è¦†ç›–çŽ‡
- **æž„å»ºæ—¶é—´**: ~5 ç§’
- **æµ‹è¯•æ‰§è¡Œ**: ~2 ç§’ (Vitest)
- **ç›‘æŽ§**: é›†æˆ Sentry è¿›è¡Œå®žæ—¶é”™è¯¯è¿½è¸ª

### æ€§èƒ½ç›®æ ‡

- **æµ‹è¯•è¦†ç›–çŽ‡**: æ‰€æœ‰æŒ‡æ ‡ > 80%
- **æž„å»ºæ—¶é—´**: < 30 ç§’
- **æµ‹è¯•æ‰§è¡Œ**: < 10 ç§’

## ðŸ”® æœªæ¥æž¶æž„è€ƒè™‘

### å¯æ‰©å±•æ€§

- **æ¨¡å—è”é‚¦ (Module Federation)**: å¾®å‰ç«¯æž¶æž„
- **çŠ¶æ€ç®¡ç†**: é’ˆå¯¹å¤æ‚çŠ¶æ€è€ƒè™‘ Redux Toolkit
- **API å±‚**: é›†æˆ GraphQL ä»¥å®žçŽ°é«˜æ•ˆæ•°æ®èŽ·å–

### æ€§èƒ½

- **æœåŠ¡ç«¯æ¸²æŸ“ (SSR)**: è€ƒè™‘è¿ç§»è‡³ Next.js
- **æ¸è¿›å¼ Web åº”ç”¨ (PWA)**: ç¦»çº¿èƒ½åŠ›
- **Web Workers**: åŽå°ä»»åŠ¡å¤„ç†

### å¼€å‘ä½“éªŒ

- **Storybook**: ç»„ä»¶æ–‡æ¡£åŒ–
- **è§†è§‰å›žå½’æµ‹è¯•**: é›†æˆ Chromatic
- **æ€§èƒ½é¢„ç®—**: è‡ªåŠ¨åŒ–æ€§èƒ½ç›‘æŽ§
